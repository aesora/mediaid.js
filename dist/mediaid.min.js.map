{"version":3,"sources":["../src/index.js","../src/tools.js","../src/parsers/asf.js","../src/parsers/qtff.js","../src/parsers/riff.js","../src/fileId.js"],"names":["main","cbhandler","cbcalled","value","cb","meta","timer","clearTimeout","arguments","length","mediaid","file","ext","timeout","type","isNaN","TypeError","window","File","FileReader","FileList","Blob","console","warn","error","fileid","parser","hasOwnProperty","setTimeout","reader","readAsArrayBuffer","onload","evt","bytes","Uint8Array","target","result","hexEncodeArray","tool","arrToHex","arr","s","i","code","bytesToInt","le","ret","bytesToString","wchar","String","fromCharCode","asf","maxpos","abort","getObject","guid","subarray","size","log","getMetaData","pos","tlength","alength","clength","dlength","title","artist","description","parseASF","object","count","Math","max","qtff","getAtom","readDataAtom","atom","parent","flags","decodeURI","parseQTFF","atom2","pos2","riff","getChunk","tag","ceil","parseRIFF","child","hdr","chunk","val","min","extension"],"mappings":"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","file":"mediaid.min.js","sourcesContent":["function main(){\n\tif(arguments.length < 3)\n\t\treturn mediaid;\n\tvar file = arguments[0],\n\t\text = arguments[1],\n\t\ttimeout = arguments.length > 3 ? arguments[2] : 1000,\n\t\tcb = arguments[arguments.length-1],\n\t\ttype = null, meta = {}, timer = false, cbcalled = {value:false};\n\tif(typeof cb !== 'function' || isNaN(timeout) || typeof ext !== 'string')\n\t\tthrow new TypeError('Bad arguments');\n\tif(!(window.File && window.FileReader && window.FileList && window.Blob)){\n\t\tconsole.warn('The File APIs are not fully supported in this browser.');\n\t\treturn cb({error:'No file API support'});\n\t}\n\tif(!file instanceof Blob)\n\t\treturn cb({error:'Cannot open file'});\n\ttype = mediaid.fileid(ext);\n\tif(!type)\n\t\treturn cb({error:'Unknown file extension'});\n\tif(!mediaid.parser.hasOwnProperty(type))\n\t\treturn cb({error:'No parser for type \\'' + type + '\\''});\n\t\n\tfunction cbhandler(){\n\t\tif(!cbcalled.value){\n\t\t\tcb(meta);\n\t\t\tcbcalled.value = true;\n\t\t}\n\t\tif(timer){\n\t\t\tclearTimeout(timer);\n\t\t\ttimer=false;\n\t\t}\n\t}\n\ttimer = setTimeout(function(){\n\t\tmeta.error='Timeout';\n\t\tcbhandler();\n\t},timeout);\n\tvar reader = new FileReader();\n\treader.readAsArrayBuffer(file);\n\treader.onload = function(evt){\n\t\tvar bytes = new Uint8Array(evt.target.result);\n\t\tmediaid.parser[type](bytes, bytes.length, meta, cbcalled);\n\t\tcbhandler(meta);\n\t}\n}\n","(function(mediaid){\n\tvar hexEncodeArray = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\t\ttool = {};\n\ttool.arrToHex = function(arr){\n\t\tvar s = '';\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tvar code = arr[i];\n\t\t\ts += hexEncodeArray[code >>> 4];\n\t\t\ts += hexEncodeArray[code & 0x0F];\n\t\t}\n\t\treturn s;\n\t};\n\ttool.bytesToInt = function(arr,le){\n\t\tvar ret=0;\n\t\tif(le){\n\t\t\tfor(var i=arr.length-1; i>=0; i--){\n\t\t\t\tret*=0x100;\n\t\t\t\tret+=arr[i];\n\t\t\t}\n\t\t}else{\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tret*=0x100;\n\t\t\t\tret+=arr[i];\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t};\n\ttool.bytesToString = function(arr,wchar){\n\t\tvar ret='';\n\t\tif(wchar){\n\t\t\tfor(var i=0; i+1<arr.length; i+=2){\n\t\t\t\tret+=String.fromCharCode(arr[i] + arr[i+1] * 0x100);\n\t\t\t}\n\t\t}else{\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tret+=String.fromCharCode(arr[i]);\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t};\n\tmediaid.tool = tool;\n}(mediaid));\n","(function(mediaid){\n\tmediaid.parser.asf = function(bytes, maxpos, meta, abort){\n\t\tvar bytesToInt = mediaid.tool.bytesToInt,\n\t\t\tbytesToString = mediaid.tool.bytesToString,\n\t\t\tarrToHex = mediaid.tool.arrToHex;\n\t\tfunction getObject(bytes){\n\t\t\tif(bytes.length > 23){\n\t\t\t\tvar guid = arrToHex(bytes.subarray(0, 16));\n\t\t\t\t\tsize = bytesToInt(bytes.subarray(16, 24),true);\n\t\t\t\treturn {size:size, guid:guid};\n\t\t\t}else{\n\t\t\t\tconsole.log('unexpected EOF');\n\t\t\t\treturn {size:bytes.length+1, guid:null};\n\t\t\t}\n\t\t}\n\t\tfunction getMetaData(bytes){\n\t\t\tvar pos = 0,\n\t\t\t\ttlength = bytesToInt(bytes.subarray(pos, pos+=2),true),\n\t\t\t\talength = bytesToInt(bytes.subarray(pos, pos+=2),true),\n\t\t\t\tclength = bytesToInt(bytes.subarray(pos, pos+=2),true),\n\t\t\t\tdlength = bytesToInt(bytes.subarray(pos, pos+=2),true);\n\t\t\tpos += 2; // skip length of rating\n\t\t\tif(tlength > 0) meta.title = bytesToString(bytes.subarray(pos,pos+=tlength),true);\n\t\t\tif(alength > 0) meta.artist = bytesToString(bytes.subarray(pos,pos+=alength),true);\n\t\t\tif(dlength > 0) meta.description = bytesToString(bytes.subarray(pos+=clength,pos+=dlength),true);\n\t\t\treturn;\n\t\t}\n\t\tfunction parseASF(bytes, maxpos){\n\t\t\tvar pos = 0;\n\t\t\twhile(pos<maxpos && !abort.value){\n\t\t\t\tvar object = getObject(bytes.subarray(pos));\n\t\t\t\tif(object.guid==='3026b2758e66cf11a6d900aa0062ce6c'){\n\t\t\t\t\tobject.count = bytesToInt(bytes.subarray(24, 28),true);\n\t\t\t\t\tparseASF(bytes.subarray(pos + 30), object.size);\n\t\t\t\t\treturn;\n\t\t\t\t}else if(object.guid==='3326b2758e66cf11a6d900aa0062ce6c'){\n\t\t\t\t\tgetMetaData(bytes.subarray(pos + 24));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tpos+=Math.max(object.size,24);\n\t\t\t}\n\t\t}\n\t\tparseASF(bytes,maxpos);\n\t};\n}(mediaid));\n","(function(mediaid){\n\tmediaid.parser.qtff = function(bytes, maxpos, meta, abort){\n\t\tvar bytesToInt = mediaid.tool.bytesToInt,\n\t\t\tbytesToString = mediaid.tool.bytesToString;\n\t\tfunction getAtom(bytes){\n\t\t\tif(bytes.length > 7){\n\t\t\t\tvar size = bytesToInt(bytes.subarray(0, 4)),\n\t\t\t\t\ttype = bytesToString(bytes.subarray(4, 8));\n\t\t\t\treturn {size:size, type:type};\n\t\t\t}else{\n\t\t\t\tconsole.log('unexpected EOF');\n\t\t\t\treturn {size:bytes.length+1, type:''};\n\t\t\t}\n\t\t}\n\t\tfunction readDataAtom(atom, bytes, pos, parent){\n\t\t\tvar ret = null,\n\t\t\t\tflags = bytesToInt(bytes.subarray(pos+8, pos+12));\n\t\t\tif(atom.size <= 16)\n\t\t\t\treturn null;\n\t\t\tswitch(flags){\n\t\t\t\tcase 0:\n\t\t\t\tcase 21:\n\t\t\t\t\tret = atom.size !== 24 ? null : bytesToInt(bytes.subarray(pos+16, pos+24));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tret = bytesToString(bytes.subarray(pos+16, pos+atom.size));\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t\tswitch(parent){\n\t\t\t\tcase decodeURI(\"%C2%A9nam\"):\n\t\t\t\t\tparent = 'title';\n\t\t\t\t\tbreak;\n\t\t\t\tcase decodeURI(\"%C2%A9ART\"):\n\t\t\t\t\tparent = 'artist'\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(ret != null)\n\t\t\t\tmeta[parent] = ret;\n\t\t\treturn ret;\n\t\t}\n\t\tfunction parseQTFF(atom, bytes, pos, parent){\n\t\t\tvar pos2 = pos+8;\n\t\t\tvar atom2;\n\t\t\twhile(pos2<bytes.length&&pos2<pos+atom.size&&!abort.value){\n\t\t\t\tatom2 = getAtom(bytes.subarray(pos2));\n\t\t\t\tif(atom2.type==='moov' || atom2.type === 'udta'||atom2.type === 'meta'||atom2.type === 'ilst'||parent==='ilst'){\n\t\t\t\t\tparseQTFF(atom2, bytes, pos2, atom2.type);\n\t\t\t\t}else if(atom2.type === 'data'){\n\t\t\t\t\treadDataAtom(atom2, bytes, pos2, parent);\n\t\t\t\t}\n\t\t\t\tpos2 += Math.max(atom2.size,4);\n\t\t\t}\n\t\t}\n\t\tparseQTFF({size:bytes.length,type:'root'},bytes,-8,'');\n\t};\n}(mediaid));\n","(function(mediaid){\n\tmediaid.parser.riff = function(bytes, maxpos, meta, abort){\n\t\tvar bytesToInt = mediaid.tool.bytesToInt,\n\t\t\tbytesToString = mediaid.tool.bytesToString;\n\t\tfunction getChunk(bytes){\n\t\t\tif(bytes.length > 7){\n\t\t\t\tvar tag = bytesToString(bytes.subarray(0,4)),\n\t\t\t\t\tsize = bytesToInt(bytes.subarray(4, 8),true)+8;\n\t\t\t\tsize = Math.ceil(size/4)*4; // fix for some avi files\n\t\t\t\treturn {size:size, type:tag};\n\t\t\t}else{\n\t\t\t\tmeta.error = 'Unexpected EOF';\n\t\t\t\treturn {size:bytes.length+1, type:null};\n\t\t\t}\n\t\t}\n\t\tfunction parseRIFF(bytes, maxpos,child){\n\t\t\tvar pos = 0;\n\t\t\tvar hdr = bytesToString(bytes.subarray(pos,pos+=4));\n\t\t\tif(!child){\n\t\t\t\tvar size = bytesToInt(bytes.subarray(pos,pos+=4),true)+pos;\n\t\t\t\tpos+=4;\n\t\t\t\tif(hdr !== 'RIFF' || size > bytes.length){\n\t\t\t\t\tmeta.error = 'Invalid file';\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(hdr !== 'INFO'){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(pos<maxpos && !abort.value){\n\t\t\t\tvar chunk = getChunk(bytes.subarray(pos));\n\t\t\t\tif(chunk.type==='LIST'){\n\t\t\t\t\tif(parseRIFF(bytes.subarray(pos+8),chunk.size-8,true)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}else if(hdr === 'INFO'){\n\t\t\t\t\tvar val = bytesToString(bytes.subarray(pos+8,Math.min(pos+chunk.size,maxpos)));\n\t\t\t\t\tswitch(chunk.type){\n\t\t\t\t\t\tcase 'IART':\n\t\t\t\t\t\t\tmeta.artist = val;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'INAM':\n\t\t\t\t\t\t\tmeta.title = val;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tmeta[chunk.type] = val;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpos+=Math.max(chunk.size,8);\n\t\t\t}\n\t\t\treturn hdr === 'INFO';\n\t\t}\n\t\tparseRIFF(bytes,maxpos);\n\t};\n}(mediaid));\n","(function(mediaid){\n\tmediaid.fileid = function(extension){\n\t\tswitch(extension){\n\t\t\tcase '.mp4':\n\t\t\tcase '.mov':\n\t\t\tcase '.m4v':\n\t\t\tcase '.m4a':\n\t\t\tcase '.m4p':\n\t\t\tcase '.m4b':\n\t\t\tcase '.m4r':\n\t\t\t\treturn 'qtff';\n\t\t\tcase '.avi':\n\t\t\tcase '.wav':\n\t\t\t\treturn 'riff';\n\t\t\tcase '.wmv':\n\t\t\tcase '.wma':\n\t\t\tcase '.asf':\n\t\t\t\treturn 'asf';\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t};\n}(mediaid));\n"]}