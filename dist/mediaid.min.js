/*! mediaid - v1.0.0 - 26.03.2016
 * Copyright 2016-2016 Matthias Breithaupt
 * Licensed under the MIT license.
 */
!function(a){function b(){function b(){k.value||(g(i),k.value=!0),j&&(clearTimeout(j),j=!1)}if(arguments.length<3)return c;var d=arguments[0],e=arguments[1],f=arguments.length>3?arguments[2]:1e3,g=arguments[arguments.length-1],h=null,i={},j=!1,k={value:!1};if("function"!=typeof g||isNaN(f)||"string"!=typeof e)throw new TypeError("Bad arguments");if(!(a.File&&a.FileReader&&a.FileList&&a.Blob))return console.warn("The File APIs are not fully supported in this browser."),g({error:"No file API support"});if(!d instanceof Blob)return g({error:"Cannot open file"});if(h=c.fileid(e),!h)return g({error:"Unknown file extension"});if(!c.parser.hasOwnProperty(h))return g({error:"No parser for type '"+h+"'"});j=setTimeout(function(){i.error="Timeout",b()},f);var l=new FileReader;l.readAsArrayBuffer(d),l.onload=function(a){var d=new Uint8Array(a.target.result);c.parser[h](d,d.length,i,k),b(i)}}var c={version:"1.0.0",parser:{}};!function(a){var b=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],c={};c.arrToHex=function(a){for(var c="",d=0;d<a.length;d++){var e=a[d];c+=b[e>>>4],c+=b[15&e]}return c},c.bytesToInt=function(a,b){var c=0;if(b)for(var d=a.length-1;d>=0;d--)c*=256,c+=a[d];else for(var d=0;d<a.length;d++)c*=256,c+=a[d];return c},c.bytesToString=function(a,b){var c="";if(b)for(var d=0;d+1<a.length;d+=2)c+=String.fromCharCode(a[d]+256*a[d+1]);else for(var d=0;d<a.length;d++)c+=String.fromCharCode(a[d]);return c},a.tool=c}(c),function(a){a.parser.asf=function(b,c,d,e){function f(a){if(a.length>23){var b=k(a.subarray(0,16));return size=i(a.subarray(16,24),!0),{size:size,guid:b}}return console.log("unexpected EOF"),{size:a.length+1,guid:null}}function g(a){var b=0,c=i(a.subarray(b,b+=2),!0),e=i(a.subarray(b,b+=2),!0),f=i(a.subarray(b,b+=2),!0),g=i(a.subarray(b,b+=2),!0);b+=2,c>0&&(d.title=j(a.subarray(b,b+=c),!0)),e>0&&(d.artist=j(a.subarray(b,b+=e),!0)),g>0&&(d.description=j(a.subarray(b+=f,b+=g),!0))}function h(a,b){for(var c=0;b>c&&!e.value;){var d=f(a.subarray(c));if("3026b2758e66cf11a6d900aa0062ce6c"===d.guid)return d.count=i(a.subarray(24,28),!0),void h(a.subarray(c+30),d.size);if("3326b2758e66cf11a6d900aa0062ce6c"===d.guid)return void g(a.subarray(c+24));c+=Math.max(d.size,24)}}var i=a.tool.bytesToInt,j=a.tool.bytesToString,k=a.tool.arrToHex;h(b,c)}}(c),function(a){a.parser.qtff=function(b,c,d,e){function f(a){if(a.length>7){var b=i(a.subarray(0,4)),c=j(a.subarray(4,8));return{size:b,type:c}}return console.log("unexpected EOF"),{size:a.length+1,type:""}}function g(a,b,c,e){var f=null,g=i(b.subarray(c+8,c+12));if(a.size<=16)return null;switch(g){case 0:case 21:f=24!==a.size?null:i(b.subarray(c+16,c+24));break;case 1:f=j(b.subarray(c+16,c+a.size));break;default:return null}switch(e){case decodeURI("%C2%A9nam"):e="title";break;case decodeURI("%C2%A9ART"):e="artist"}return null!=f&&(d[e]=f),f}function h(a,b,c,d){for(var i,j=c+8;j<b.length&&j<c+a.size&&!e.value;)i=f(b.subarray(j)),"moov"===i.type||"udta"===i.type||"meta"===i.type||"ilst"===i.type||"ilst"===d?h(i,b,j,i.type):"data"===i.type&&g(i,b,j,d),j+=Math.max(i.size,4)}var i=a.tool.bytesToInt,j=a.tool.bytesToString;h({size:b.length,type:"root"},b,-8,"")}}(c),function(a){a.parser.riff=function(b,c,d,e){function f(a){if(a.length>7){var b=i(a.subarray(0,4)),c=h(a.subarray(4,8),!0)+8;return c=4*Math.ceil(c/4),{size:c,type:b}}return d.error="Unexpected EOF",{size:a.length+1,type:null}}function g(a,b,c){var j=0,k=i(a.subarray(j,j+=4));if(c){if("INFO"!==k)return}else{var l=h(a.subarray(j,j+=4),!0)+j;if(j+=4,"RIFF"!==k||l>a.length)return void(d.error="Invalid file")}for(;b>j&&!e.value;){var m=f(a.subarray(j));if("LIST"===m.type){if(g(a.subarray(j+8),m.size-8,!0))return}else if("INFO"===k){var n=i(a.subarray(j+8,Math.min(j+m.size,b)));switch(m.type){case"IART":d.artist=n;break;case"INAM":d.title=n;break;default:d[m.type]=n}}j+=Math.max(m.size,8)}return"INFO"===k}var h=a.tool.bytesToInt,i=a.tool.bytesToString;g(b,c)}}(c),function(a){a.fileid=function(a){switch(a){case".mp4":case".mov":case".m4v":case".m4a":case".m4p":case".m4b":case".m4r":return"qtff";case".avi":case".wav":return"riff";case".wmv":case".wma":case".asf":return"asf";default:return null}}}(c),a.mediaid=b}(window);
//# sourceMappingURL=mediaid.min.js.map